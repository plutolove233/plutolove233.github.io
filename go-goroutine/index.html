<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Goå¹¶å‘ - äºŒåäºŒç”»ç”Ÿçš„åšå®¢</title><meta name=Description content="å˜å¾—æ›´å¼ºï¼Œæ— é™è¿›æ­¥"><meta property="og:title" content="Goå¹¶å‘">
<meta property="og:description" content="å‰ç½®çŸ¥è¯† ä¸²è¡Œï¼šæŒ‡æŒ‰ç…§ä¸€å®šçš„é¡ºåºå®Œæˆä¸€ç»„ä»»åŠ¡ã€‚ä¾‹å¦‚ä¼šå…ˆæ¸…æ´—é£Ÿæã€å†å¯¹é£Ÿæåˆ‡å—å¤‡ä»½ã€æœ€åå†è¿›è¡Œçƒ¹é¥ª å¹¶å‘ï¼šæŒ‡åŒä¸€æ—¶é—´æ®µå†…ï¼Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚æ¯”å¦‚ï¼šå¯ä»¥"><meta property="og:type" content="article"><meta property="og:url" content="http://plutolove233.github.io/go-goroutine/"><meta property="og:image" content="http://plutolove233.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-04T14:17:12+08:00"><meta property="article:modified_time" content="2025-01-04T14:17:12+08:00"><meta property="og:site_name" content="äºŒåäºŒç”»ç”Ÿçš„ç½‘ç«™"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://plutolove233.github.io/logo.png"><meta name=twitter:title content="Goå¹¶å‘"><meta name=twitter:description content="å‰ç½®çŸ¥è¯† ä¸²è¡Œï¼šæŒ‡æŒ‰ç…§ä¸€å®šçš„é¡ºåºå®Œæˆä¸€ç»„ä»»åŠ¡ã€‚ä¾‹å¦‚ä¼šå…ˆæ¸…æ´—é£Ÿæã€å†å¯¹é£Ÿæåˆ‡å—å¤‡ä»½ã€æœ€åå†è¿›è¡Œçƒ¹é¥ª å¹¶å‘ï¼šæŒ‡åŒä¸€æ—¶é—´æ®µå†…ï¼Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚æ¯”å¦‚ï¼šå¯ä»¥"><meta name=application-name content="æˆ‘çš„ç½‘ç«™"><meta name=apple-mobile-web-app-title content="æˆ‘çš„ç½‘ç«™"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/logo.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://plutolove233.github.io/go-goroutine/><link rel=prev href=http://plutolove233.github.io/go-error/><link rel=next href=http://plutolove233.github.io/todotree/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Goå¹¶å‘","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/plutolove233.github.io\/go-goroutine\/"},"genre":"posts","keywords":"golang, study","wordcount":2189,"url":"http:\/\/plutolove233.github.io\/go-goroutine\/","datePublished":"2025-01-04T14:17:12+08:00","dateModified":"2025-01-04T14:17:12+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"äºŒåäºŒç”»ç”Ÿ"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=äºŒåäºŒç”»ç”Ÿçš„åšå®¢><img class="lazyload logo" src=/svg/loading.min.svg data-src=/home.png data-srcset="/home.png, /home.png 1.5x, /home.png 2x" data-sizes=auto alt=/home.png title=/home.png><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>æ–‡ç«  </a><a class=menu-item href=/tags/>æ ‡ç­¾ </a><a class=menu-item href=/categories/>åˆ†ç±» </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=äºŒåäºŒç”»ç”Ÿçš„åšå®¢><img class="lazyload logo" src=/svg/loading.min.svg data-src=/home.png data-srcset="/home.png, /home.png 1.5x, /home.png 2x" data-sizes=auto alt=/home.png title=/home.png><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>æ–‡ç« </a><a class=menu-item href=/tags/ title>æ ‡ç­¾</a><a class=menu-item href=/categories/ title>åˆ†ç±»</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Goå¹¶å‘</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/about title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>äºŒåäºŒç”»ç”Ÿ</a>
</span>&nbsp;<span class=post-category>included in <a href=/categories/golang%E4%B9%8B%E8%B7%AF/><i class="far fa-folder fa-fw" aria-hidden=true></i>golangä¹‹è·¯</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2025-01-04>2025-01-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2189 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#å‰ç½®çŸ¥è¯†>å‰ç½®çŸ¥è¯†</a></li><li><a href=#goroutine>goroutine</a></li><li><a href=#channel>channel</a><ul><li><a href=#channelæ¥æ”¶å’Œå‘é€æ•°æ®>channelæ¥æ”¶å’Œå‘é€æ•°æ®</a></li><li><a href=#æœ‰ç¼“å†²å’Œæ— ç¼“å†²channelä¹‹é—´çš„åŒºåˆ«>æœ‰ç¼“å†²å’Œæ— ç¼“å†²channelä¹‹é—´çš„åŒºåˆ«</a></li><li><a href=#å…³é—­channel>å…³é—­channel</a></li><li><a href=#for-rangeæ¥æ”¶channelæ•°æ®>for-rangeæ¥æ”¶channelæ•°æ®</a></li></ul></li><li><a href=#selectå¤šè·¯å¤ç”¨>selectå¤šè·¯å¤ç”¨</a></li></ul></nav></div></div><div class=content id=content><h2 id=å‰ç½®çŸ¥è¯†>å‰ç½®çŸ¥è¯†</h2><ol><li>ä¸²è¡Œï¼šæŒ‡æŒ‰ç…§ä¸€å®šçš„é¡ºåºå®Œæˆä¸€ç»„ä»»åŠ¡ã€‚ä¾‹å¦‚ä¼šå…ˆæ¸…æ´—é£Ÿæã€å†å¯¹é£Ÿæåˆ‡å—å¤‡ä»½ã€æœ€åå†è¿›è¡Œçƒ¹é¥ª</li><li>å¹¶å‘ï¼šæŒ‡<strong>åŒä¸€æ—¶é—´æ®µ</strong>å†…ï¼Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚æ¯”å¦‚ï¼šå¯ä»¥è¾¹åˆ·ç”µè§†å‰§ï¼Œè¾¹åˆ·è¯¾ğŸ˜</li><li>å¹¶è¡Œï¼šæŒ‡<strong>åŒä¸€æ—¶åˆ»</strong>ï¼ŒåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæ¯”å¦‚ï¼šå¯ä»¥è®©ä½ çš„å†¤ç§èˆå‹å¸®ä½ åˆ·è¯¾ï¼Œè€Œä½ ï¼Œæˆ‘çš„æœ‹å‹ï¼Œä½ å°±å¯ä»¥ä¸“å¿ƒè‡´å¿—çš„çœ‹ç”µè§†å‰§äº†ğŸ˜œ</li><li>è¿›ç¨‹ï¼ˆprocessï¼‰ï¼šç¨‹åºåœ¨æ“ä½œç³»ç»Ÿä¸­çš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œç³»ç»Ÿè¿›è¡Œ<strong>èµ„æºåˆ†é…å’Œè°ƒåº¦</strong>çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ã€‚</li><li>çº¿ç¨‹ï¼ˆthreadï¼‰ï¼šæ“ä½œç³»ç»ŸåŸºäºè¿›ç¨‹å¼€å¯çš„è½»é‡çº§è¿›ç¨‹ï¼Œæ˜¯æ“ä½œç³»ç»Ÿ<strong>è°ƒåº¦æ‰§è¡Œ</strong>çš„æœ€å°å•ä½ã€‚</li><li>åç¨‹ï¼ˆcoroutineï¼‰ï¼šéæ“ä½œç³»ç»Ÿæä¾›è€Œæ˜¯ç”±ç”¨æˆ·è‡ªè¡Œåˆ›å»ºå’Œæ§åˆ¶çš„ç”¨æˆ·æ€â€˜çº¿ç¨‹â€™ï¼Œæ¯”çº¿ç¨‹æ›´è½»é‡çº§ã€‚</li></ol><p>äº†è§£è¿™äº›æœ¯è¯­ï¼Œèƒ½å¤Ÿå¯¹ä¹‹åGoå¹¶å‘æœ‰æ›´åŠ æ¸…æ™°çš„è®¤è¯†ã€‚</p><h2 id=goroutine>goroutine</h2><p>Goroutineæ˜¯Goå¹¶å‘å¼€å‘ä¸­æœ€åŸºç¡€ã€æœ€å…³é”®çš„ä¸€éƒ¨åˆ†ï¼Œå¤§é‡Goç¨‹åºéƒ½ä¼šç”±æµ·é‡çš„goroutineæ„æˆï¼Œä»¥å®ç°å¹¶å‘ã€‚</p><p>goroutineæ˜¯Goçš„æ ¸å¿ƒï¼Œæ¯ä¸ªgoç¨‹åºè‡³å°‘ä¼šåŒ…å«ä¸€ä¸ªmain goroutineï¼Œå®ƒä¼šåœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºã€‚</p><p>åœ¨Goä¸­ï¼Œä¸éœ€è¦è‡ªå·±å®ç°è¿›ç¨‹ã€çº¿ç¨‹ä»¥åŠåç¨‹ï¼Œå½“æŸä¸ªåŠŸèƒ½éœ€è¦å¹¶å‘è®¿é—®æ—¶ï¼Œä½ åªéœ€è¦å°†å…¶åŒ…è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å¼€å¯ä¸€ä¸ªgoroutineæ‰§è¡Œè¿™ä¸ªå‡½æ•°å°±è¡Œäº†ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å¼€å¯goroutineå®ç°å¹¶å‘çš„ä¾‹å­ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>work</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// åˆ›å»º10ä¸ªåç¨‹ï¼Œåˆ†åˆ«æ‰“å°1ï½10æ•°å­—
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>go</span> <span class=nf>work</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ç­‰å¾…2sï¼Œé¿å…ä¸»åç¨‹è¿‡æ—©ç»“æŸ
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚ä¸Šè¿°ä¾‹å­ï¼Œä»…éœ€è¦ä½¿ç”¨å…³é”®å­—<code>go</code>ï¼Œå¹¶è·Ÿéšä¸€ä¸ªå‡½æ•°ï¼Œå³å¯å®ç°å¤šåç¨‹ï¼Œä¸Šè¿°ä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ï¼š
<img class=lazyload src=/svg/loading.min.svg data-src=./result1.png data-srcset="./result1.png, ./result1.png 1.5x, ./result1.png 2x" data-sizes=auto alt=./result1.png title=./result1.png></p><p>å½“ä½¿ç”¨<code>go</code>å…³é”®å­—ï¼Œå¯åŠ¨ä¸€ä¸ªåç¨‹åï¼Œä¼šäº¤ç”±Goè¿è¡Œæ—¶ï¼ˆruntimeï¼‰è¿›è¡Œè°ƒåº¦ï¼Œå…¶ä¸­æ¶‰åŠåˆ°æ›´åŠ åº•å±‚ä»¥åŠæ“ä½œç³»ç»Ÿçš„çŸ¥è¯†ï¼Œæ¨èå¤§å®¶é˜…è¯»åˆ˜ä¸¹å†°è€å¸ˆçš„è¿™ç¯‡æ–‡ç« <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>ï¼Œå…¶ä¸­å…¨é¢çš„è®²è§£äº†GMPæ¨¡å‹ä»¥åŠåç¨‹è°ƒåº¦é€»è¾‘ï¼Œè¿™é‡Œå°±ä¸å†è¯¦ç»†å±•å¼€äº†ã€‚</p><h2 id=channel>channel</h2><p>å•çº¯åˆ›å»ºå¤šä¸ªåç¨‹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå¦‚ä½•èƒ½å¤Ÿåœ¨åç¨‹ä¹‹é—´è¿›è¡Œé€šè®¯ï¼Œä»è€Œæ§åˆ¶å¤šä¸ªåç¨‹åˆä½œå®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œæ‰æ˜¯å¹¶å‘è¿½æ±‚çš„ç›®æ ‡ã€‚ä½†æ˜¯åœ¨goä¸­è¯¥å¦‚ä½•å®ç°åç¨‹ä¹‹é—´çš„é€šè®¯å‘¢ï¼Ÿ</p><p>goä¸­é‡‡ç”¨é€šä¿¡å…±äº«è€Œä¸æ˜¯é‡‡ç”¨é‡‡ç”¨å…±äº«å†…å­˜æ¥å®ç°é€šä¿¡ï¼Œchannelèƒ½å¤Ÿåœ¨ä¸åŒçš„åç¨‹å»ºç«‹æ¡¥æ¢ï¼Œä»¥æ§åˆ¶ä¸åŒçš„åç¨‹ã€‚channelå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§é˜Ÿåˆ—ï¼Œå…ˆè¿›å…ˆå‡ºï¼Œä»…ä»…èµ·åˆ°ä¸€ä¸ªé€šä¿¡çš„ä½œç”¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ€æ ·å®šä¹‰å’Œåˆå§‹åŒ–channel</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>ch1</span> <span class=kd>chan</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>ch2</span> <span class=kd>chan</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>ch1</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>ch2</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{},</span> <span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å£°æ˜channelå˜é‡çš„æ ¼å¼ä¸º<code>var å˜é‡å chan å…ƒç´ ç±»å‹</code>ã€‚channelç±»å‹å˜é‡ä¹Ÿå¾—éœ€è¦åˆå§‹åŒ–åï¼Œæ‰èƒ½ä½¿ç”¨ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œchannelé‡‡ç”¨makeæ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶å¯ä»¥è®¾ç½®å…¶ç¼“å†²åŒºçš„å¤§å°ã€‚</p><h3 id=channelæ¥æ”¶å’Œå‘é€æ•°æ®>channelæ¥æ”¶å’Œå‘é€æ•°æ®</h3><p>åœ¨goä¸­ï¼Œé‡‡ç”¨ç®­å¤´ç¬¦å·æ¥å®ç°å¯¹channelå˜é‡çš„æ•°æ®ä¼ é€’ï¼Œå¹¶é‡‡ç”¨<code>&lt;-</code>å®ç°å¯¹channelå‘é€å’Œæ¥æ”¶æ•°æ®çš„æ“ä½œï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>work</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>data</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span> <span class=nx>ch</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;channel is empty&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ch</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=nf>work</span><span class=p>(</span><span class=nx>ch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ch</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>1</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å½“<code>&lt;-</code>åè·Ÿéšchannelç±»å‹å˜é‡æ—¶ï¼Œå°±æ˜¯æŒ‡ä»channelä¸­æ¥æ”¶æ•°æ®ï¼›å½“<code>&lt;-</code>åè·Ÿéšchannlå…ƒç´ ç±»å‹ä¸€è‡´çš„å˜é‡æˆ–æ•°æ®æ—¶ï¼Œè¡¨ç¤ºå‘channelå‘é€æ•°æ®ã€‚</p><h3 id=æœ‰ç¼“å†²å’Œæ— ç¼“å†²channelä¹‹é—´çš„åŒºåˆ«>æœ‰ç¼“å†²å’Œæ— ç¼“å†²channelä¹‹é—´çš„åŒºåˆ«</h3><p>æ— ç¼“å†²çš„é€šé“åˆç§°ä¸ºé˜»å¡çš„é€šé“ï¼Œæ— ç¼“å†²çš„é€šé“åªæœ‰åœ¨æœ‰æ¥æ”¶æ–¹<strong>èƒ½å¤Ÿ</strong>æ¥æ”¶å€¼çš„æ—¶å€™æ‰èƒ½å‘é€æˆåŠŸï¼Œå¦åˆ™ä¼šä¸€ç›´å¤„äº<strong>ç­‰å¾…å‘é€</strong>çš„é˜¶æ®µã€‚åŒç†ï¼Œå¦‚æœå¯¹ä¸€ä¸ªæ— ç¼“å†²é€šé“æ‰§è¡Œæ¥æ”¶æ“ä½œæ—¶ï¼Œæ²¡æœ‰ä»»ä½•å‘é€šé“ä¸­å‘é€å€¼çš„æ“ä½œé‚£ä¹ˆä¹Ÿä¼šå¯¼è‡´æ¥æ”¶<strong>æ“ä½œé˜»å¡</strong>ã€‚
ä½¿ç”¨æ— ç¼“å†²é€šé“è¿›è¡Œé€šä¿¡å°†å¯¼è‡´å‘é€å’Œæ¥æ”¶çš„<code>goroutine</code>åŒæ­¥åŒ–ã€‚å› æ­¤ï¼Œæ— ç¼“å†²é€šé“ä¹Ÿè¢«ç§°ä¸ºåŒæ­¥é€šé“ã€‚</p><p>åªè¦é€šé“çš„å®¹é‡å¤§äºé›¶ï¼Œé‚£ä¹ˆè¯¥é€šé“å°±å±äºæœ‰ç¼“å†²çš„é€šé“ï¼Œé€šé“çš„å®¹é‡è¡¨ç¤ºé€šé“ä¸­æœ€å¤§èƒ½å­˜æ”¾çš„å…ƒç´ æ•°é‡ã€‚å½“é€šé“å†…å·²æœ‰å…ƒç´ æ•°<strong>è¾¾åˆ°æœ€å¤§å®¹é‡</strong>åï¼Œå†å‘é€šé“æ‰§è¡Œå‘é€æ“ä½œå°±ä¼š<strong>é˜»å¡</strong>ï¼Œé™¤éæœ‰ä»é€šé“æ‰§è¡Œæ¥æ”¶æ“ä½œã€‚</p><h3 id=å…³é—­channel>å…³é—­channel</h3><p>å½“å‘é€šé“ä¸­å‘é€å®Œæ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>close</code>å‡½æ•°æ¥å…³é—­é€šé“ã€‚å½“ä¸€ä¸ªé€šé“è¢«å…³é—­åï¼Œå†å¾€è¯¥é€šé“å‘é€å€¼ä¼šå¼•å‘panicï¼Œä»è¯¥é€šé“å–å€¼çš„æ“ä½œä¼šå…ˆå–å®Œé€šé“ä¸­çš„å€¼ã€‚é€šé“å†…çš„å€¼è¢«æ¥æ”¶å®Œåå†å¯¹é€šé“æ‰§è¡Œæ¥æ”¶æ“ä½œå¾—åˆ°çš„å€¼ä¼šä¸€ç›´éƒ½æ˜¯å¯¹åº”å…ƒç´ ç±»å‹çš„é›¶å€¼ã€‚å¹¶å¯ä»¥é€šè¿‡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>data</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span> <span class=kd>chan</span> <span class=c1>// å½“channelå…³é—­äº†ï¼Œokä¸ºfalseï¼Œå…¶ä½™æƒ…å†µå‡ä¸ºtrue
</span></span></span></code></pre></td></tr></table></div></div><p>æ¥åˆ¤æ–­channelæ˜¯å¦å…³é—­ã€‚</p><h3 id=for-rangeæ¥æ”¶channelæ•°æ®>for-rangeæ¥æ”¶channelæ•°æ®</h3><p>å¦‚æœéœ€è¦é€šè¿‡è½®è¯¢çš„æ–¹å¼æ¥ä»channelä¸­æ¥æ”¶æ•°æ®ï¼Œé€šå¸¸æ˜¯ä»¥è¿™ç§æ–¹å¼æ¥å®ç°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>query</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>data</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=o>&lt;-</span> <span class=nx>ch</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;channel is closed!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸Šè¿°ä»£ç å¯ä»¥ä¼˜åŒ–ä¸ºè¿™æ ·ï¼Œèƒ½å¤Ÿæ›´åŠ ç®€æ´ï¼Œè¡¨è¾¾çš„æ„æ€ä¹Ÿæ›´åŠ æ¸…æ™°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>query</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>data</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>ch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;channel is closed!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=selectå¤šè·¯å¤ç”¨>selectå¤šè·¯å¤ç”¨</h2><p>æœ‰æ—¶ä¼šéœ€è¦ä»å¤šä¸ªchannelä¸­æ¥æ”¶æ•°æ®ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨selectå¤šè·¯å¤ç”¨æ–¹å¼ï¼Œå®ƒå¯ä»¥åŒæ—¶å“åº”å¤šä¸ªé€šé“çš„æ“ä½œã€‚</p><p><code>select</code>å’Œ<code>switch</code>ç›¸ä¼¼ï¼Œä¼šæœ‰<code>case</code>å’Œ<code>default</code>åˆ†æ”¯ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=o>&lt;-</span><span class=nx>ch1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=o>...</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=nx>data</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>ch2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=o>...</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=nx>ch3</span> <span class=o>&lt;-</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=o>...</span>
</span></span><span class=line><span class=cl>        <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Select è¯­å¥å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>å¯å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ª channel çš„å‘é€/æ¥æ”¶æ“ä½œã€‚</li><li>å¦‚æœå¤šä¸ª case åŒæ—¶æ»¡è¶³ï¼Œselect ä¼š<strong>éšæœºé€‰æ‹©</strong>ä¸€ä¸ªæ‰§è¡Œã€‚</li><li>å¯¹äºæ²¡æœ‰ case çš„ select ä¼šä¸€ç›´<strong>é˜»å¡</strong>ï¼Œå¯ç”¨äºé˜»å¡ main å‡½æ•°ï¼Œé˜²æ­¢é€€å‡ºã€‚</li><li>å¦‚æœå­˜åœ¨defaultåˆ†æ”¯ï¼Œä¸”æ²¡æœ‰caseåˆ†æ”¯æ»¡è¶³ï¼Œåˆ™ä¼šæ‰§è¡Œdefaultåˆ†æ”¯çš„å†…å®¹ã€‚</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://zhuanlan.zhihu.com/p/323271088 target=_blank rel="noopener noreffer">Golangè°ƒåº¦å™¨GPMåŸç†ä¸è°ƒåº¦å…¨åˆ†æâ€”â€”åˆ˜ä¸¹å†°</a>
&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-01-04</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/go-goroutine/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=http://plutolove233.github.io/go-goroutine/ data-title=Goå¹¶å‘ data-hashtags=golang,study><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=http://plutolove233.github.io/go-goroutine/ data-hashtag=golang><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=http://plutolove233.github.io/go-goroutine/ data-title=Goå¹¶å‘><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=http://plutolove233.github.io/go-goroutine/ data-title=Goå¹¶å‘><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on å¾®åš" data-sharer=weibo data-url=http://plutolove233.github.io/go-goroutine/ data-title=Goå¹¶å‘ data-ralateuid=yizhigopher><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/golang/>golang</a>,&nbsp;<a href=/tags/study/>study</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/go-error/ class=prev rel=prev title="Go Error"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Go Error</a>
<a href=/todotree/ class=next rel=next title=Todotreeæ’ä»¶è®¾ç½®>Todotreeæ’ä»¶è®¾ç½®<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.120.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/about target=_blank>äºŒåäºŒç”»ç”Ÿ</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/typeit/index.umd.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"id-1":"ä¸ºäº†æ›´ç¾å¥½çš„æ˜å¤©è€Œæˆ˜","id-2":"ä¸ºäº†æ›´ç¾å¥½çš„æ˜å¤©è€Œæˆ˜"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:50,type:"lunr"},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>